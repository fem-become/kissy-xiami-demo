KISSY.add("xiami/transition/search",function(b,n,r,j,d,k){var c=n.all,a,g,e=this.getName(),o=c("#body"),m=d.getHeader(e),l=null;return{init:function(p){var q=this;d.setTitle("");0!=p.id?(a||(a=c('<div class="mod-page"></div>').appendTo(o),c('<input type="text" id="J_searchContent" class="search-txt"/><input type="button" id="J_search" value="" class="search-btn"/><div class="album-loading" style="height: 60px;background-image: none;"><ul class="album-list J_searchResult"></ul></div>').appendTo(a)),
g=c(".J_searchResult"),d.setTitle("歌曲搜索"),c("#J_search").on(j.Gesture.tap,function(){var b=c("#J_searchContent").val();q.fetchData(b)})):d.setTitle(l);m.contents().length||m.append(e);k.setCurrentMod(e);c(".do-search").hide();b.Player=new b.Base;b.Player&&b.Player.on("go-back",function(){c(".do-search").show()})},getEl:function(){return a},fetchData:function(a){var e=this;b.IO({dataType:"jsonp",url:"http://test.fem.taobao.net:3000/search/suggest/"+a,success:function(b){var a,h=b.songs;a=""+('<div class="album-list-count song-count">共'+
h.length+"首歌曲</div>");for(var i=0;i<h.length;i++){var f=e.getListTemplate(),f=f.replace(RegExp("{{song_id}}","gi"),h[i].id),f=f.replace(RegExp("{{title}}","gi"),h[i].title);a+=f}g.html(a+"</ul>");g.all(".J_album_play").on(j.Gesture.tap,function(){var a=c(this).attr("data-id"),a=a.replace("http://www.xiami.com/song/","");k.playOne({id:a})});g.all(".J_album_add_list").on(j.Gesture.tap,function(a){a=c(a.target).attr("data-id");a.replace("http://www.xiami.com/song/","");k.addToList({id:a})});l=b.title;
d.setTitle(l)}})},getListTemplate:function(){return'<li><h3>{{title}}</h3><div class="album-btn-group"><button class="J_album_play play inline" data-id="{{song_id}}">&nbsp;</button><button class="J_album_add_list list inline" data-id="{{song_id}}">&nbsp;</button></div></li>'}}},{requires:"node,./index,event,../header,../suspender,overlay,scrollview,scrollview/plugin/scrollbar,./album.css,./search.css".split(",")});
