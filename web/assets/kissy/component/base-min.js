/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: May 20 22:58
*/
KISSY.add("component/base",function(d,h,f,e){d.mix(h,{Controller:f,Render:e});return h},{requires:["./base/impl","./base/controller","./base/render"]});
KISSY.add("component/base/box-render",function(d,h,f,e){function m(a){"number"==typeof a&&(a+="px");return a}function a(){var a,b,c=this.get("elStyle"),e=this.get("elCls"),d;if(!this.get("srcNode")){a=this.getAttrs();d=this.get("renderData");for(b in a)"renderData"!=b&&!(b in d)&&(d[b]=this.get(b));a=d.width;b=d.height;d=d.visible;a&&(c.width=m(a));b&&(c.height=m(b));e.push(d?this.getCssClassWithState("shown"):this.getCssClassWithState("hidden"))}}var c=d.all,b=d.UA,o=d.Env.host.document;a.ATTRS=
{id:{},el:{},elCls:{sync:0,setter:function(a){"string"==typeof a&&(a=a.split(/\s+/));return a}},elStyle:{sync:0},width:{sync:0},height:{sync:0},elAttrs:{sync:0},elBefore:{sync:0},render:{},visible:{sync:0},contentTpl:{value:"{{{content}}}"},renderData:{},childrenElSelectors:{value:{}}};a.HTML_PARSER={content:function(a){return a.html()}};a.prototype={__createDom:function(){var a=this,b=a.get("renderData"),k;if(k=a.get("srcNode")){if((k=c(k))&&!k[0].id)k[0].id="ks-component"+d.guid()}else{k=e+a.get("contentTpl")+
"</div>";k=(new f(k,{commands:{getCssClassWithState:function(b,c){return a.getCssClassWithState(c.params[0])}}})).render(b);k=c(k);var b=a.get("childrenElSelectors"),i;for(i in b){var j=b[i];"function"===typeof j?a.setInternal(i,j(k)):a.setInternal(i,k.all(d.substitute(j,this.get("renderData"))))}}a.setInternal("el",k)},__renderUI:function(){if(!this.get("srcNode")){var a=this.get("render"),b=this.get("el"),c=this.get("elBefore");c?b.insertBefore(c,void 0):a?b.appendTo(a,void 0):b.appendTo(o.body,
void 0)}},_onSetWidth:function(a){this.get("el").width(a)},_onSetHeight:function(a){this.get("el").height(a)},_onSetContent:function(a){var c=this.get("el");c.html(a);9>b.ie&&!this.get("allowTextSelection")&&c.unselectable()},_onSetVisible:function(a){var b=this.get("el"),c=this.getCssClassWithState("shown"),d=this.getCssClassWithState("hidden");a?(b.removeClass(d),b.addClass(c)):(b.removeClass(c),b.addClass(d))},__destructor:function(){var a=this.get("el");a&&a.remove()}};return a},{requires:["node",
"xtemplate","./box-tpl"]});KISSY.add("component/base/box-tpl",function(){return'<div id="ks-component{{id}}" class="{{getCssClassWithState ""}} {{#each elCls}} {{.}} {{/each}} " {{#each elAttrs}} {{xkey}}="{{.}}" {{/each}} style=" {{#each elStyle}} {{xkey}}:{{.}}; {{/each}} ">'});
KISSY.add("component/base/box",function(d){function h(){}h.ATTRS={id:{view:1,valueFn:function(){return d.guid()}},content:{view:1,value:""},contentTpl:{view:1},renderData:{view:1,value:{}},childrenElSelectors:{view:1},width:{view:1},height:{view:1},elCls:{view:1,value:[]},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{view:1},el:{view:1},render:{view:1},visible:{sync:0,value:!0,view:1},srcNode:{view:1}};h.prototype={_onSetVisible:function(d){this.fire(d?"show":"hide")},show:function(){this.render();
this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this}};return h});
KISSY.add("component/base/controller",function(d,h,f,e,m,a,c,b){function o(g){return function(a){this==a.target&&(a=a.newVal,this.get("view").set(g,a))}}function s(g){return function(a){var c,d=this.get("view");d&&(c=d.get(g));return c===b?a:c}}function t(g){if(g.target===this){var a=g.component,b=this.get("children"),g=g.index;b.splice(g,0,a);this.get("rendered")&&(a=this.renderChild(a,g));this.fire("afterAddChild",{component:a,index:g})}}function k(g){if(g.target===this){var a=g.component,b,c,d=
g.destroy,e=this.get("children"),g=g.index;-1!=g&&e.splice(g,1);a.setInternal&&a.setInternal("parent",null);if(d)a.destroy&&a.destroy();else if(a.get&&(b=a.get("el")))b=b[0],(c=b.parentNode)&&c.removeChild(b);this.fire("afterRemoveChild",{component:a,index:g})}}function i(g){var c,e,f,i={},j,k=g.get("xrender");c=g.getAttrs();for(f in c)if(e=c[f],e.view){if((j=g.get(f))!==b)i[f]=j;g.on("after"+d.ucfirst(f)+"Change",o(f));e.getter=s(f)}g=g.constructor;for(e=[];g&&g!=r;)(c=a.getXClassByConstructor(g))&&
e.push(c),g=g.superclass&&g.superclass.constructor;i.ksComponentCss=e;return new k(i)}function j(a,b){var c=a.relatedTarget;return c&&(c===b[0]||b.contains(c))}function l(a,b){return function(c){if(!a.get("disabled"))a[b](c)}}var q=d.Env.host.document.documentMode||d.UA.ie,n=f.Gesture,p=d.Features.isTouchSupported(),r=m.extend([h],{isController:!0,getCssClassWithPrefix:a.getCssClassWithPrefix,initializer:function(){var a=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:t});this.publish("beforeRemoveChild",
{defaultFn:k});a.prefixCls=a.prefixCls||this.get("prefixCls")},createChild:function(a){return e.create(a,this)},createDom:function(){var a;this.setInternal("view",a=i(this));a.create();a=a.getKeyEventTarget();this.get("allowTextSelection")||a.unselectable()},renderUI:function(){this.get("view").render();this.renderChildren()},bindUI:function(){var a=this.getKeyEventTarget();if(this.get("focusable"))a.on("focus",l(this,"handleFocus")).on("blur",l(this,"handleBlur")).on("keydown",l(this,"handleKeydown"));
if(this.get("handleMouseEvents")){a=this.get("el");if(!p)a.on("mouseenter",l(this,"handleMouseEnter")).on("mouseleave",l(this,"handleMouseLeave")).on("contextmenu",l(this,"handleContextMenu"));a.on(n.start,l(this,"handleMouseDown")).on(n.end,l(this,"handleMouseUp")).on("touchcancel",l(this,"handleMouseUp")).on(n.tap,l(this,"performActionInternal"));if(q&&9>q)a.on("dblclick",l(this,"handleDblClick"))}},renderChildren:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)this.renderChild(b[a],
a)},_onSetFocused:function(a){var b=this.getKeyEventTarget()[0];a?b.focus():b.ownerDocument.activeElement==b&&b.ownerDocument.body.focus()},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},getChildrenContainerEl:function(){return this.get("view").getChildrenContainerEl()},getKeyEventTarget:function(){return this.get("view").getKeyEventTarget()},addChild:function(a,c){var d=this.get("children");c===b&&(c=d.length);a=this.createChild(a);
this.fire("beforeAddChild",{component:a,index:c});return a},renderChild:function(a,b){var c,e;c=this.get("children");var f;"undefined"===typeof b&&(b=d.indexOf(a,c));a=this.createChild(a);c[b]=a;this.create();f=this.getChildrenContainerEl();e=f[0];c=e.children[b]||null;a.get("rendered")?(f=a.get("el")[0],f.parentNode!=e&&e.insertBefore(f,c)):(c?a.set("elBefore",c):a.set("render",f),a.render());return a},removeChild:function(a,c){c===b&&(c=!0);this.fire("beforeRemoveChild",{component:a,index:d.indexOf(a,
this.get("children")),destroy:c})},removeChildren:function(a){var b,c=[].concat(this.get("children"));for(b=0;b<c.length;b++)this.removeChild(c[b],a);return this},getChildAt:function(a){return this.get("children")[a]||null},handleDblClick:function(a){this.performActionInternal(a)},handleMouseOver:function(a){var b=this.get("el");j(a,b)||this.handleMouseEnter(a)},handleMouseOut:function(a){var b=this.get("el");j(a,b)||this.handleMouseLeave(a)},handleMouseEnter:function(a){this.set("highlighted",!!a)},
handleMouseLeave:function(a){this.set("active",!1);this.set("highlighted",!a)},handleMouseDown:function(a){var b;if(1==a.which||p)if(b=this.getKeyEventTarget(),this.get("activeable")&&this.set("active",!0),this.get("focusable")&&(b[0].focus(),this.set("focused",!0)),!this.get("allowTextSelection"))b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!=b&&"textarea"!=b&&a.preventDefault()},handleMouseUp:function(a){this.get("active")&&(1==a.which||p)&&this.set("active",!1)},handleContextMenu:function(){},
handleFocus:function(a){this.set("focused",!!a);this.fire("focus")},handleBlur:function(a){this.set("focused",!a);this.fire("blur")},handleKeyEventInternal:function(a){return a.keyCode==f.KeyCodes.ENTER?this.performActionInternal(a):b},handleKeydown:function(a){return this.handleKeyEventInternal(a)?(a.halt(),!0):b},performActionInternal:function(){},destructor:function(){var a,b=this.get("view"),c=this.get("children");for(a=0;a<c.length;a++)c[a].destroy&&c[a].destroy();b&&b.destroy()}},{ATTRS:{handleMouseEvents:{value:!0},
focusable:{value:!0,view:1},allowTextSelection:{view:1,value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},children:{value:[]},prefixCls:{value:d.config("component/prefixCls")||"ks-",view:1},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:c},defaultChildCfg:{view:1,value:{}}}},{xclass:"controller"});return r},{requires:"./box,event,./impl,./uibase,./manager,./render".split(",")});
KISSY.add("component/base/impl",function(d,h,f){return{Manager:f,UIBase:h,create:function(e,h){var a;if(e){!e.isController&&h&&(d.mix(e,h.get("defaultChildCfg"),!1),!e.xclass&&e.prefixXClass&&(e.xclass=e.prefixXClass,e.xtype&&(e.xclass+="-"+e.xtype)));if(!e.isController&&(a=e.xclass))a=f.getConstructorByXClass(a),e=new a(e);e.isController&&h&&e.setInternal("parent",h)}return e}}},{requires:["./uibase","./manager"]});
KISSY.add("component/base/manager",function(d){function h(a){for(var a=d.trim(a).split(/\s+/),c=0;c<a.length;c++)a[c]&&(a[c]=this.get("prefixCls")+a[c]);return a.join(" ")}var f={},e={},m={__instances:e,addComponent:function(a,c){e[a]=c},removeComponent:function(a){delete e[a]},getComponent:function(a){return e[a]},getCssClassWithPrefix:h,getXClassByConstructor:function(a){for(var c in f)if(f[c].constructor==a)return c;return 0},getConstructorByXClass:function(a){for(var a=a.split(/\s+/),c=-1,b,d=
null,e=0;e<a.length;e++){var h=f[a[e]];if(h&&(b=h.priority)>c)c=b,d=h.constructor}return d},setConstructorByXClass:function(a,c){d.isFunction(c)?f[a]={constructor:c,priority:0}:(c.priority=c.priority||0,f[a]=c)}};m.getCssClassWithPrefix=h;return m});
KISSY.add("component/base/render",function(d,h,f,e,m){return e.extend([h],{initializer:function(){var a=this.get("elAttrs"),c=this.get("elCls"),b;if(b=this.get("disabled"))c.push(this.getCssClassWithState("disabled")),a["aria-disabled"]="true";this.get("highlighted")&&c.push(this.getCssClassWithState("hover"));this.get("focusable")&&(a.hideFocus="true",a.tabindex=b?"-1":"0")},isRender:1,getCssClassWithState:function(a){var c=this.get("ksComponentCss");if(!c)return"";(a=a||"")&&(a="-"+a);return this.getCssClassWithPrefix(c.join(a+
" ")+a)},getCssClassWithPrefix:m.getCssClassWithPrefix,getKeyEventTarget:function(){return this.get("el")},_onSetHighlighted:function(a){var c=this.getCssClassWithState("hover");this.get("el")[a?"addClass":"removeClass"](c)},_onSetDisabled:function(a){var c=this.getCssClassWithState("disabled");this.get("el")[a?"addClass":"removeClass"](c).attr("aria-disabled",a);this.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var c=this.getCssClassWithState("active");
this.get("el")[a?"addClass":"removeClass"](c).attr("aria-pressed",!!a)},_onSetFocused:function(a){var c=this.get("el"),b=this.getCssClassWithState("focused");c[a?"addClass":"removeClass"](b)},getChildrenContainerEl:function(){return this.get("el")}},{ATTRS:{prefixCls:{},focusable:{},focused:{sync:0},active:{sync:0},disabled:{sync:0},highlighted:{sync:0}},HTML_PARSER:{disabled:function(a){var c=this.getCssClassWithState("disabled");return a.hasClass(c)}}})},{requires:["./box-render","./impl","./uibase",
"./manager"]});
KISSY.add("component/base/uibase",function(d,h,f,e,m){var f=d.noop,a=h.extend({constructor:function(){var b;a.superclass.constructor.apply(this,arguments);this.decorateInternal&&(b=this.get("srcNode"))&&this.decorateInternal(b);this.get("autoRender")&&this.render()},bindInternal:f,syncInternal:f,initializer:function(){var a,c=d.one(this.get("srcNode"));(a=this.get("id"))&&e.addComponent(a,this);if(c){var f=this.constructor,h,k;k=this.collectConstructorChains();for(a=k.length-1;0<=a;a--)if(f=k[a],
h=f.HTML_PARSER){var f=c,i=void 0,j=void 0,j=void 0;for(i in h)j=h[i],d.isFunction(j)?(j=j.call(this,f),j!==m&&this.setInternal(i,j)):"string"==typeof j?this.setInternal(i,f.one(j)):d.isArray(j)&&j[0]&&this.setInternal(i,f.all(j[0]))}this.setInternal("srcNode",c)}},create:function(){this.get("created")||(this.fire("beforeCreateDom"),this.callMethodByHierarchy("createDom","__createDom"),this.setInternal("created",!0),this.fire("afterCreateDom"),this.callPluginsMethod("createDom"));return this},render:function(){this.get("rendered")||
(this.create(m),this.fire("beforeRenderUI"),this.callMethodByHierarchy("renderUI","__renderUI"),this.fire("afterRenderUI"),this.callPluginsMethod("renderUI"),this.fire("beforeBindUI"),a.superclass.bindInternal.call(this),this.callMethodByHierarchy("bindUI","__bindUI"),this.fire("afterBindUI"),this.callPluginsMethod("bindUI"),a.superclass.syncInternal.call(this),this.sync(),this.setInternal("rendered",!0));return this},sync:function(){this.fire("beforeSyncUI");this.callMethodByHierarchy("syncUI","__syncUI");
this.fire("afterSyncUI");this.callPluginsMethod("syncUI")},createDom:f,renderUI:f,bindUI:f,syncUI:f,plug:function(){var b;b=this.get("plugins");a.superclass.plug.apply(this,arguments);b=b[b.length-1];this.get("rendered")?(b.pluginCreateDom&&b.pluginCreateDom(this),b.pluginRenderUI&&b.pluginRenderUI(this),b.pluginBindUI&&b.pluginBindUI(this),b.pluginSyncUI&&b.pluginSyncUI(this)):this.get("created")&&b.pluginCreateDom&&b.pluginCreateDom(this);return this},destructor:function(){var a;(a=this.get("id"))&&
e.removeComponent(a)}},{name:"UIBase",ATTRS:{rendered:{value:!1},created:{value:!1},xclass:{valueFn:function(){return e.getXClassByConstructor(this.constructor)}}}}),c=a.extend;d.mix(a,{HTML_PARSER:{},extend:function o(a,f,h){var i=d.makeArray(arguments),j={},l,m=i.length,n=i[m-1];if(l=n.xclass)i[m-2].name=l;i=c.apply(this,i);d.isArray(a)&&(d.each(a.concat(i),function(a){a&&d.each(a.HTML_PARSER,function(a,c){j[c]=a})}),i.HTML_PARSER=j);l&&e.setConstructorByXClass(l,{constructor:i,priority:n.priority});
i.extend=o;return i}});return a},{requires:["rich-base","node","./manager"]});
