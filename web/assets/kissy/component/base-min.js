/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: May 23 00:43
*/
KISSY.add("component/base",function(e,k,g,c){e.mix(k,{Controller:g,Render:c});return k},{requires:["./base/impl","./base/controller","./base/render"]});
KISSY.add("component/base/box-render",function(e,k,g,c){function l(f){"number"==typeof f&&(f+="px");return f}function j(){var f,a,c=this.get("elStyle"),b=this.get("elCls"),i;if(!this.get("srcNode")){f=this.getAttrs();i=this.get("renderData");for(a in f)"renderData"!=a&&!(a in i)&&(i[a]=this.get(a));f=i.width;a=i.height;i=i.visible;f&&(c.width=l(f));a&&(c.height=l(a));i||b.push(this.getBaseCssClasses("hidden"))}}var n=e.all,b=e.UA,a=e.Env.host.document;j.ATTRS={id:{},el:{},elCls:{sync:0},elStyle:{sync:0},
width:{sync:0},height:{sync:0},elAttrs:{sync:0},elBefore:{sync:0},render:{},visible:{sync:0},contentTpl:{value:"{{{content}}}"},renderData:{},childrenElSelectors:{value:{}}};j.HTML_PARSER={content:function(f){return f.html()}};j.prototype={__createDom:function(){var f=this,a=f.get("renderData"),b;if(b=f.get("srcNode")){if((b=n(b))&&!b[0].id)b[0].id="ks-component"+e.guid()}else{b=c+f.get("contentTpl")+"</div>";b=(new g(b,{commands:{getBaseCssClasses:function(a,b){return f.getBaseCssClasses(b.params[0])}}})).render(a);
b=n(b);var a=f.get("childrenElSelectors"),h;for(h in a){var i=a[h];"function"===typeof i?f.setInternal(h,i(b)):f.setInternal(h,b.all(e.substitute(i,this.get("renderData"))))}}f.setInternal("el",b)},__renderUI:function(){if(!this.get("srcNode")){var f=this.get("render"),b=this.get("el"),c=this.get("elBefore");c?b.insertBefore(c,void 0):f?b.appendTo(f,void 0):b.appendTo(a.body,void 0)}},_onSetWidth:function(a){this.get("el").width(a)},_onSetHeight:function(a){this.get("el").height(a)},_onSetContent:function(a){var c=
this.get("el");c.html(a);9>b.ie&&!this.get("allowTextSelection")&&c.unselectable()},_onSetVisible:function(a){var b=this.get("el"),c=this.getBaseCssClasses("hidden");a?b.removeClass(c):b.addClass(c)},__destructor:function(){var a=this.get("el");a&&a.remove()}};return j},{requires:["node","xtemplate","./box-tpl"]});KISSY.add("component/base/box-tpl",function(){return'<div id="ks-component{{id}}" class="{{getBaseCssClasses ""}} {{#each elCls}} {{.}} {{/each}} " {{#each elAttrs}} {{xkey}}="{{.}}" {{/each}} style=" {{#each elStyle}} {{xkey}}:{{.}}; {{/each}} ">'});
KISSY.add("component/base/box",function(e){function k(){}k.ATTRS={id:{view:1,valueFn:function(){return e.guid()}},content:{view:1,value:""},contentTpl:{view:1},renderData:{view:1,value:{}},childrenElSelectors:{view:1},width:{view:1},height:{view:1},elCls:{view:1,value:[],setter:function(e){"string"==typeof e&&(e=e.split(/\s+/));return e||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{view:1},el:{view:1},render:{view:1},visible:{sync:0,value:!0,view:1},srcNode:{view:1}};k.prototype=
{_onSetVisible:function(e){this.fire(e?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this}};return k});
KISSY.add("component/base/controller",function(e,k,g,c,l,j,n,b){function a(d){return function(a){this==a.target&&(a=a.newVal,this.get("view").set(d,a))}}function f(d){return function(a){var c,f=this.get("view");f&&(c=f.get(d));return c===b?a:c}}function s(d){if(d.target===this){var a=d.component,b=this.get("children"),d=d.index;b.splice(d,0,a);this.get("rendered")&&(a=this.renderChild(a,d));this.fire("afterAddChild",{component:a,index:d})}}function t(d){if(d.target===this){var a=d.component,b,c,f=
d.destroy,e=this.get("children"),d=d.index;-1!=d&&e.splice(d,1);a.setInternal&&a.setInternal("parent",null);if(f)a.destroy&&a.destroy();else if(a.get&&(b=a.get("el")))b=b[0],(c=b.parentNode)&&c.removeChild(b);this.fire("afterRemoveChild",{component:a,index:d})}}function h(d){var c,i,h,l={},j,g=d.get("xrender");c=d.getAttrs();for(h in c)if(i=c[h],i.view){if((j=d.get(h))!==b)l[h]=j;d.on("after"+e.ucfirst(h)+"Change",a(h));i.getter=f(h)}return new g(l)}function i(d,a){var b=d.relatedTarget;return b&&
(b===a[0]||a.contains(b))}function m(d,a){return function(b){if(!d.get("disabled"))d[a](b)}}var q=e.Env.host.document.documentMode||e.UA.ie,o=g.Gesture,p=e.Features.isTouchSupported(),r=l.extend([k],{isController:!0,getBaseCssClass:function(d){return n.getBaseCssClass(this,d)},initializer:function(){var d,a=this.get("defaultChildCfg");d=this.prefixCls=this.get("prefixCls");this.componentCssClasses=this.get("componentCssClasses");this.publish("beforeAddChild",{defaultFn:s});this.publish("beforeRemoveChild",
{defaultFn:t});a.prefixCls=a.prefixCls||d},createChild:function(d){return c.create(d,this)},createDom:function(){var d;this.setInternal("view",d=h(this));d.create();d=d.getKeyEventTarget();this.get("allowTextSelection")||d.unselectable()},renderUI:function(){this.get("view").render();this.renderChildren()},bindUI:function(){var d=this.getKeyEventTarget();if(this.get("focusable"))d.on("focus",m(this,"handleFocus")).on("blur",m(this,"handleBlur")).on("keydown",m(this,"handleKeydown"));if(this.get("handleMouseEvents")){d=
this.get("el");if(!p)d.on("mouseenter",m(this,"handleMouseEnter")).on("mouseleave",m(this,"handleMouseLeave")).on("contextmenu",m(this,"handleContextMenu"));d.on(o.start,m(this,"handleMouseDown")).on(o.end,m(this,"handleMouseUp")).on("touchcancel",m(this,"handleMouseUp")).on(o.tap,m(this,"performActionInternal"));if(q&&9>q)d.on("dblclick",m(this,"handleDblClick"))}},renderChildren:function(){var d,a=this.get("children");for(d=0;d<a.length;d++)this.renderChild(a[d],d)},_onSetFocused:function(d){var a=
this.getKeyEventTarget()[0];d?a.focus():a.ownerDocument.activeElement==a&&a.ownerDocument.body.focus()},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},getChildrenContainerEl:function(){return this.get("view").getChildrenContainerEl()},getKeyEventTarget:function(){return this.get("view").getKeyEventTarget()},addChild:function(d,a){var c=this.get("children");a===b&&(a=c.length);d=this.createChild(d);this.fire("beforeAddChild",
{component:d,index:a});return d},renderChild:function(d,a){var b,c;b=this.get("children");var f;"undefined"===typeof a&&(a=e.indexOf(d,b));d=this.createChild(d);b[a]=d;this.create();f=this.getChildrenContainerEl();c=f[0];b=c.children[a]||null;d.get("rendered")?(f=d.get("el")[0],f.parentNode!=c&&c.insertBefore(f,b)):(b?d.set("elBefore",b):d.set("render",f),d.render());return d},removeChild:function(a,c){c===b&&(c=!0);this.fire("beforeRemoveChild",{component:a,index:e.indexOf(a,this.get("children")),
destroy:c})},removeChildren:function(a){var b,c=[].concat(this.get("children"));for(b=0;b<c.length;b++)this.removeChild(c[b],a);return this},getChildAt:function(a){return this.get("children")[a]||null},handleDblClick:function(a){this.performActionInternal(a)},handleMouseOver:function(a){var b=this.get("el");i(a,b)||this.handleMouseEnter(a)},handleMouseOut:function(a){var b=this.get("el");i(a,b)||this.handleMouseLeave(a)},handleMouseEnter:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.set("active",
!1);this.set("highlighted",!a)},handleMouseDown:function(a){var b;if(1==a.which||p)if(b=this.getKeyEventTarget(),this.get("activeable")&&this.set("active",!0),this.get("focusable")&&(b[0].focus(),this.set("focused",!0)),!this.get("allowTextSelection"))b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!=b&&"textarea"!=b&&a.preventDefault()},handleMouseUp:function(a){this.get("active")&&(1==a.which||p)&&this.set("active",!1)},handleContextMenu:function(){},handleFocus:function(a){this.set("focused",!!a);
this.fire("focus")},handleBlur:function(a){this.set("focused",!a);this.fire("blur")},handleKeyEventInternal:function(a){return a.keyCode==g.KeyCodes.ENTER?this.performActionInternal(a):b},handleKeydown:function(a){return this.handleKeyEventInternal(a)?(a.halt(),!0):b},performActionInternal:function(){},destructor:function(){var a,b=this.get("view"),c=this.get("children");for(a=0;a<c.length;a++)c[a].destroy&&c[a].destroy();b&&b.destroy()}},{ATTRS:{handleMouseEvents:{value:!0},focusable:{value:!0,view:1},
allowTextSelection:{view:1,value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},children:{value:[]},prefixCls:{value:e.config("component/prefixCls")||"ks-",view:1},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:n},componentCssClasses:{view:1,valueFn:function(){for(var a=this.constructor,b,c=[];a&&a!=r;)(b=j.getXClassByConstructor(a))&&c.push(b),
a=a.superclass&&a.superclass.constructor;return c}},defaultChildCfg:{view:1,value:{}}}},{xclass:"controller"});return r},{requires:"./box,event,./impl,./uibase,./manager,./render".split(",")});
KISSY.add("component/base/impl",function(e,k,g){return{Manager:g,UIBase:k,create:function(c,l){var j;if(c){!c.isController&&l&&(e.mix(c,l.get("defaultChildCfg"),!1),!c.xclass&&c.prefixXClass&&(c.xclass=c.prefixXClass,c.xtype&&(c.xclass+="-"+c.xtype)));if(!c.isController&&(j=c.xclass))j=g.getConstructorByXClass(j),c=new j(c);c.isController&&l&&c.setInternal("parent",l)}return c}}},{requires:["./uibase","./manager"]});
KISSY.add("component/base/manager",function(){var e=0,k={},g={};return{__instances:g,addComponent:function(c,e){g[c]=e},removeComponent:function(c){delete g[c]},getComponent:function(c){return g[c]},getXClassByConstructor:function(c){for(var e in k)if(k[e].constructor==c)return e;return 0},getConstructorByXClass:function(c){var c=c.split(/\s+/),e=-1,j,g,b,a=null;for(g=0;g<c.length;g++)if((b=k[c[g]])&&(j=b.priority)>e)e=j,a=b.constructor;return a},setConstructorByXClass:function(c,g){k[c]={constructor:g,
priority:e++}}}});
KISSY.add("component/base/render",function(e,k,g,c){function l(a){a||(a=[""]);"string"==typeof a&&(a=a.split(/\s+/));return a}function j(a,b,c){for(var e="",h=0,i=c.length,b=a+b;h<i;h++)a=(a=c[h])?"-"+a:a,e+=" "+b+a;return e}var n=e.trim,b;return b=c.extend([k],{initializer:function(){var a=this.get("elAttrs"),b=this.get("elCls"),c;if(c=this.get("disabled"))b.push(this.getBaseCssClasses("disabled")),a["aria-disabled"]="true";this.get("highlighted")&&b.push(this.getBaseCssClasses("hover"));this.get("focusable")&&
(a.hideFocus="true",a.tabindex=c?"-1":"0")},isRender:1,getBaseCssClasses:function(a){return b.getBaseCssClasses(this,a)},getBaseCssClass:function(a){return b.getBaseCssClass(this,a)},getKeyEventTarget:function(){return this.get("el")},_onSetHighlighted:function(a){var b=this.getBaseCssClasses("hover");this.get("el")[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.getBaseCssClasses("disabled");this.get("el")[a?"addClass":"removeClass"](b).attr("aria-disabled",a);this.get("focusable")&&
this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.get("el")[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.get("el"),c=this.getBaseCssClasses("focused");b[a?"addClass":"removeClass"](c)},getChildrenContainerEl:function(){return this.get("el")}},{getBaseCssClasses:function(a,b){for(var b=l(b),c=a.componentCssClasses,e=0,h="",i=c.length,g=a.prefixCls;e<i;e++)h+=j(g,c[e],b);return n(h)},
getBaseCssClass:function(a,b){return n(j(a.prefixCls,a.componentCssClasses[0],l(b)))},ATTRS:{prefixCls:{setter:function(a){this.prefixCls=a}},componentCssClasses:{setter:function(a){this.componentCssClasses=a}},focusable:{},focused:{sync:0},active:{sync:0},disabled:{sync:0},highlighted:{sync:0}},HTML_PARSER:{disabled:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}}})},{requires:["./box-render","./impl","./uibase"]});
KISSY.add("component/base/uibase",function(e,k,g,c,l){var g=e.noop,j=k.extend({constructor:function(){var b;j.superclass.constructor.apply(this,arguments);this.decorateInternal&&(b=this.get("srcNode"))&&this.decorateInternal(b);this.get("autoRender")&&this.render()},bindInternal:g,syncInternal:g,initializer:function(){var b,a=e.one(this.get("srcNode"));(b=this.get("id"))&&c.addComponent(b,this);if(a){var f=this.constructor,g,j;j=this.collectConstructorChains();for(b=j.length-1;0<=b;b--)if(f=j[b],
g=f.HTML_PARSER){var f=a,h=void 0,i=void 0,i=void 0;for(h in g)i=g[h],e.isFunction(i)?(i=i.call(this,f),i!==l&&this.setInternal(h,i)):"string"==typeof i?this.setInternal(h,f.one(i)):e.isArray(i)&&i[0]&&this.setInternal(h,f.all(i[0]))}this.setInternal("srcNode",a)}},create:function(){this.get("created")||(this.fire("beforeCreateDom"),this.callMethodByHierarchy("createDom","__createDom"),this.setInternal("created",!0),this.fire("afterCreateDom"),this.callPluginsMethod("createDom"));return this},render:function(){this.get("rendered")||
(this.create(l),this.fire("beforeRenderUI"),this.callMethodByHierarchy("renderUI","__renderUI"),this.fire("afterRenderUI"),this.callPluginsMethod("renderUI"),this.fire("beforeBindUI"),j.superclass.bindInternal.call(this),this.callMethodByHierarchy("bindUI","__bindUI"),this.fire("afterBindUI"),this.callPluginsMethod("bindUI"),j.superclass.syncInternal.call(this),this.sync(),this.setInternal("rendered",!0));return this},sync:function(){this.fire("beforeSyncUI");this.callMethodByHierarchy("syncUI","__syncUI");
this.fire("afterSyncUI");this.callPluginsMethod("syncUI")},createDom:g,renderUI:g,bindUI:g,syncUI:g,plug:function(){var b;b=this.get("plugins");j.superclass.plug.apply(this,arguments);b=b[b.length-1];this.get("rendered")?(b.pluginCreateDom&&b.pluginCreateDom(this),b.pluginRenderUI&&b.pluginRenderUI(this),b.pluginBindUI&&b.pluginBindUI(this),b.pluginSyncUI&&b.pluginSyncUI(this)):this.get("created")&&b.pluginCreateDom&&b.pluginCreateDom(this);return this},destructor:function(){var b;(b=this.get("id"))&&
c.removeComponent(b)}},{name:"UIBase",ATTRS:{rendered:{value:!1},created:{value:!1},xclass:{valueFn:function(){return c.getXClassByConstructor(this.constructor)}}}}),n=j.extend;e.mix(j,{HTML_PARSER:{},extend:function a(f,g,j){var h=e.makeArray(arguments),i={},k,l=h.length;if(k=h[l-1].xclass)h[l-2].name=k;h=n.apply(this,h);e.isArray(f)&&(e.each(f.concat(h),function(a){a&&e.each(a.HTML_PARSER,function(a,c){i[c]=a})}),h.HTML_PARSER=i);k&&c.setConstructorByXClass(k,h);h.extend=a;return h}});return j},
{requires:["rich-base","node","./manager"]});
