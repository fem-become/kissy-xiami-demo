/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Mar 19 11:12
*/
KISSY.add("event/custom/api-impl",function(e,k,d,i){var g=d._Utils,h=g.splitAndRun;return e.mix(k,{fire:function(c,b,a){var f=void 0,l=k.getTargets(c,1),n=l&&l.length,a=a||{};h(b,function(l){var b;g.fillGroupsForEvent(l,a);l=a.type;if((b=i.getCustomEvent(c,l))||n){if(b){if(!b.hasObserver()&&!b.defaultFn&&(b.bubbles&&!n||!b.bubbles))return}else b=new i({currentTarget:c,type:l});l=b.fire(a);!1!==f&&(f=l)}});return f},publish:function(c,b,a){var f;h(b,function(l){f=i.getCustomEvent(c,l,1);e.mix(f,a)});
return c},getCustomEvent:function(c,b,a){return i.getCustomEvent(c,b,a)},addTarget:function(c,b){var a=k.getTargets(c);e.inArray(b,a)||a.push(b);return c},removeTarget:function(c,b){var a=k.getTargets(c),f=e.indexOf(b,a);-1!=f&&a.splice(f,1);return c},getTargets:function(c,b){b||(c["__~ks_bubble_targets"]=c["__~ks_bubble_targets"]||[]);return c["__~ks_bubble_targets"]},on:function(c,b,a,f){g.batchForType(function(a,f,b){f=g.normalizeParam(a,f,b);a=f.type;if(a=i.getCustomEvent(c,a,1))a.on(f)},0,b,
a,f);return c},detach:function(c,b,a,f){g.batchForType(function(a,f,b){var d=g.normalizeParam(a,f,b);(a=d.type)?(a=i.getCustomEvent(c,a,1))&&a.detach(d):(a=i.getCustomEvents(c),e.each(a,function(a){a.detach(d)}))},0,b,a,f);return c}})},{requires:["./api","event/base","./observable"]});KISSY.add("event/custom/api",function(){return{}});
KISSY.add("event/custom",function(e,k,d,i){var g={};e.each(d,function(d,c){g[c]=function(){var b=e.makeArray(arguments);b.unshift(this);return d.apply(null,b)}});d=e.mix({_ObservableCustomEvent:i,Target:g},d);e.mix(k,{Target:g,Custom:d});e.EventTarget=g;return d},{requires:["./base","./custom/api-impl","./custom/observable"]});KISSY.add("event/custom/object",function(e,k){function d(i){d.superclass.constructor.call(this);e.mix(this,i)}e.extend(d,k._Object);return d},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(e,k,d,i,g){function h(){h.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var c=g._Utils;e.extend(h,g._ObservableEvent,{constructor:h,on:function(a){a=new d(a);-1==this.findObserver(a)&&this.observers.push(a)},checkMemory:function(){var a=this.currentTarget,f=h.getCustomEvents(a);f&&(this.hasObserver()||delete f[this.type],e.isEmptyObject(f)&&delete a[b])},fire:function(a){var a=a||{},f=this.bubbles,
b=this.currentTarget,c,d=this.type,e=this.defaultFn,g,j=a,m;a.type=d;j instanceof i||(j.target=b,j=new i(j));j.currentTarget=b;a=this.notify(j);!1!==m&&(m=a);if(f&&!j.isPropagationStopped()){c=(f=k.getTargets(b,1))&&f.length||0;for(g=0;g<c&&!j.isPropagationStopped();g++)a=k.fire(f[g],d,j),!1!==m&&(m=a)}if(e&&!j.isDefaultPrevented()&&(d=h.getCustomEvent(j.target,j.type),!this.defaultTargetOnly&&!d.defaultTargetOnly||b==j.target))m=e.call(b,j);return m},notify:function(a){var b=this.observers,c,d,e=
b.length,g;for(g=0;g<e&&!a.isImmediatePropagationStopped();g++)c=b[g].notify(a,this),!1!==d&&(d=c),!1===c&&a.halt();return d},detach:function(a){var b,d=a.fn,e=a.context,g=this.currentTarget,i=this.observers,a=a.groups;if(i.length){a&&(b=c.getGroupsRe(a));var k,j,h,o,p=i.length;if(d||b){e=e||g;k=a=0;for(j=[];a<p;++a)if(h=i[a],o=h.context||g,e!=o||d&&d!=h.fn||b&&!h.groups.match(b))j[k++]=h;this.observers=j}else this.reset();this.checkMemory()}}});var b="__~ks_custom_events";h.getCustomEvent=function(a,
b,d){var c,e=h.getCustomEvents(a,d);c=e&&e[b];!c&&d&&(c=e[b]=new h({currentTarget:a,type:b}));return c};h.getCustomEvents=function(a,c){!a[b]&&c&&(a[b]={});return a[b]};return h},{requires:["./api","./observer","./object","event/base"]});KISSY.add("event/custom/observer",function(e,k){function d(){d.superclass.constructor.apply(this,arguments)}e.extend(d,k._Observer,{keys:["fn","context","groups"]});return d},{requires:["event/base"]});
